(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3695],{36732:(i,e,t)=>{"use strict";t.d(e,{default:()=>W});var o=t(81556),n=t(47256),r=t(54961),a=t(34739),s=t(39660),_=t(89120),l=t(70254),h=t(53277),c=t(95610),b=t(70218),x=t(68793),d=t(52728),k=t(47677),u=t.n(k);let w=i=>{let{basicInfo:e,featuredWorks:t=[],onViewLocation:n,onViewMoreWorks:r,onWorkClick:_,className:l=""}=i,h=(0,a.c3)("exhibition"),k=function(i,e){if(!i)return"";let t=i=>{let e=i.getFullYear(),t=String(i.getMonth()+1).padStart(2,"0"),o=String(i.getDate()).padStart(2,"0");return"".concat(e,".").concat(t,".").concat(o)},o=t(i);if(null===e)return"".concat(o," － 常設展");if(e){let i=t(e);return"".concat(o," － ").concat(i)}return o}(e.startDate,e.endDate),w=[];k&&w.push({label:h("period"),value:k}),e.location&&w.push({label:h("location"),value:e.location});let I=[];return e.description&&I.push({type:"text",content:e.description}),e.videos&&e.videos.length>0&&e.videos.forEach(i=>{I.push({type:"video",video_url:i.videoURL,thumbnail:i.thumbnail})}),(0,o.jsxs)("div",{className:"".concat(u().exhibitionIntro," ").concat(l),children:[(0,o.jsx)("h1",{className:u().exhibitionIntro__title,children:e.title}),w.length>0&&(0,o.jsxs)("div",{className:u().exhibitionIntro__info,children:[(0,o.jsx)(b.n,{items:w}),n&&(0,o.jsx)(c.$,{size:"small",fill:"outline",icon:d.yF,onClick:n,className:u().exhibitionIntro__locationButton,children:h("viewLocation")})]}),I.length>0&&(0,o.jsx)(x.U,{blocks:I}),t.length>0&&(0,o.jsxs)("div",{className:u().exhibitionIntro__worksPreview,children:[(0,o.jsxs)("div",{className:u().exhibitionIntro__worksHeader,children:[(0,o.jsxs)("div",{className:u().exhibitionIntro__worksHeaderRow,children:[(0,o.jsx)("h2",{className:u().exhibitionIntro__worksTitle,children:h("worksList")}),r&&(0,o.jsx)("button",{className:u().exhibitionIntro__viewMoreButton,onClick:r,type:"button",children:h("viewMoreWorks")})]}),(0,o.jsx)("div",{className:u().exhibitionIntro__worksDivider})]}),(0,o.jsx)("div",{className:u().exhibitionIntro__worksList,children:t.map(i=>(0,o.jsxs)("div",{className:u().exhibitionIntro__workCard,onClick:()=>null==_?void 0:_(i.workID),role:"button",tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),null==_||_(i.workID))},children:[(0,o.jsxs)("div",{className:u().exhibitionIntro__workImageWrapper,children:[(0,o.jsx)(s.$,{src:i.image,alt:i.title,width:141,height:141,className:u().exhibitionIntro__workImage}),(0,o.jsx)("div",{className:u().exhibitionIntro__workImageOverlay})]}),(0,o.jsx)("span",{className:u().exhibitionIntro__workTitle,children:i.title})]},i.workID))})]})]})};w.displayName="ExhibitionIntro";var I=t(72863),m=t(97360),p=t(28016),g=t(47469),f=t(71526),v=t(37697),D=t.n(v);let C=i=>{let e=Math.floor(i/60),t=Math.floor(i%60);return"".concat(e,":").concat(t.toString().padStart(2,"0"))},j=i=>{let{workCategories:e,exhibitionID:t,exhibitionName:r,className:s=""}=i,_=(0,a.c3)("exhibition"),{setPlaylist:l,play:h,currentTrack:c,subscribeToPlayHistory:b,getPlayHistorySnapshot:x}=(0,g.F)(),[k,u]=(0,n.useState)(!1),{getMediaInfoByVersion:w,worksToPlaylist:v}=(0,f.S)(),j=(0,n.useSyncExternalStore)(b,x,x),y=e.flatMap(i=>i.works),E=v(y,{exhibitionID:t,exhibitionName:r}),L=(0,n.useCallback)(()=>{0!==E.length&&(l(E,0),h(E[0]),u(!0))},[E,l,h]),N=(0,n.useCallback)((i,e)=>{let t=y.findIndex(e=>e.workID===i.workID);if(-1===t)return;let o=E[t];l(E,t),h(o),u(!0)},[y,E,l,h]),H=(0,n.useCallback)(i=>(null==c?void 0:c.id)===i,[c]);return(0,o.jsxs)("div",{className:"".concat(D().worksListContainer," ").concat(s),children:[(0,o.jsx)(m.$,{size:"small",fill:"solid",icon:d.Dq.Outline,onClick:L,"aria-label":_(k?"restartTour":"startTour"),className:D().worksListContainer__startButton,children:_(k?"restartTour":"startTour")}),(0,o.jsx)("div",{className:D().worksListContainer__categories,children:e.map(i=>(0,o.jsxs)("div",{className:D().worksListContainer__category,children:[(0,o.jsx)(I.U,{title:i.categoryName}),(0,o.jsx)("div",{className:D().worksListContainer__worksList,children:i.works.map((i,e)=>{let t=w(i),n=!!t.duration,r=H(i.workID),a=i.has3DModel?"3d":null,s=t.contentID?j[t.contentID]:null,_=!!s&&!s.isCompleted,l=(null==s?void 0:s.duration)||t.duration||0,h=_?C(Math.max(0,l-s.progress)):void 0;return(0,o.jsx)(p.t,{image:i.image,title:i.title,location:{floor:i.floor||"",rooms:i.room?[i.room]:[]},status:r?"playing":_?"has-played":"default",hasAudio:n,duration:n?C(t.duration):void 0,remainingTime:h,progress:_?s.progressPercent:void 0,extraIcon:a,onClick:()=>N(i,e),imageAlt:i.title},i.workID)})})]},i.categoryID))})]})};j.displayName="ExhibitionWorksList";var y=t(93855),E=t(46682),L=t(66949),N=t(53365),H=t.n(N),B=t(76241);function W(){let i=(0,r.useParams)().id,e=(0,a.c3)("exhibition"),t=(0,a.c3)("common"),{data:c,loading:b,error:x,refresh:d}=function(i){let e=(0,_._)(),[t,o]=(0,n.useState)(null),[r,a]=(0,n.useState)(!0),[s,l]=(0,n.useState)(null),[h,c]=(0,n.useState)(!1),b=(0,n.useCallback)(async()=>{try{a(!0),l(null);let t=await e.exhibition.getDetail(i);o(t),c(!navigator.onLine)}catch(i){l(i instanceof Error?i:Error("Unknown error")),c(!0)}finally{a(!1)}},[i,e.exhibition]),x=(0,n.useCallback)(async()=>{try{a(!0),l(null);let t=await e.exhibition.refresh(i);o(t),c(!1)}catch(i){l(i instanceof Error?i:Error("Refresh failed")),c(!0)}finally{a(!1)}},[i,e.exhibition]);return(0,n.useEffect)(()=>{let i=()=>{c(!1),b()},e=()=>{c(!0)};return window.addEventListener("online",i),window.addEventListener("offline",e),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",e)}},[b]),(0,n.useEffect)(()=>{b()},[b]),{data:t,loading:r,error:s,isOffline:h,refetch:b,refresh:x}}(i),[k,u]=(0,n.useState)("intro"),[I,m]=(0,n.useState)(!1),[p,v]=(0,n.useState)(!1),{setPlaylist:D,play:C,currentTrack:N,isExpanded:W}=(0,g.F)(),{getMediaInfoByVersion:S,worksToPlaylist:M}=(0,f.S)();(0,n.useEffect)(()=>{W&&I&&m(!1)},[W,I]);let[U,T]=(0,n.useState)(!1),O=(0,n.useRef)(null),A=(0,n.useRef)(null),P=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(!c||!O.current)return;let i=new IntersectionObserver(i=>{i.forEach(i=>{T(!i.isIntersecting)})},{root:null,rootMargin:"-56px 0px 0px 0px",threshold:[0,1]});return i.observe(O.current),()=>{i.disconnect()}},[c]);let R=(0,n.useCallback)(e=>{if(!c)return;let t=c.workCategories.flatMap(i=>i.works),o=t.findIndex(i=>i.workID===e);if(-1===o)return;let n=M(t,{exhibitionID:i,exhibitionName:c.basicInfo.title});D(n,o),C(n[o])},[c,i,D,C,M]),F=(0,n.useCallback)(()=>{u("works"),P.current&&P.current.scrollTo({top:0,behavior:"smooth"})},[]),z=(0,n.useCallback)(()=>{v(!0)},[]),Q=(0,n.useCallback)(e=>{if(!c)return;let t=c.workCategories.flatMap(i=>i.works),o=t.findIndex(i=>i.workID===e.workID);if(-1===o)return;let n=M(t,{exhibitionID:i,exhibitionName:c.basicInfo.title});D(n,o),C(n[o])},[c,i,D,C,M]),X=(0,n.useMemo)(()=>{if(!c)return;let i=c.workCategories.flatMap(i=>i.works).filter(i=>i.mapLocation).map(i=>{let e=S(i);return{workId:i.workID,title:i.title,imageUrl:i.image,hasAudio:!!e.url,mapLocation:i.mapLocation,spaceUid:i.spaceUid,areaUid:i.floor}}),e=c.basicInfo.spaces||[],t=e.map(i=>i.uid),o=[...new Set(e.map(i=>i.areaUid))],n=i.map(i=>i.spaceUid).filter(Boolean),r=i.map(i=>i.areaUid).filter(Boolean),a=[...new Set([...t,...n])],s=[...new Set([...o,...r])];return{exhibitionId:c.basicInfo.exhibitionID,exhibitionName:c.basicInfo.title,areaColor:"rgba(221, 181, 134, 0.3)",spaceUids:a,areaUids:s,works:i}},[c,S]);if(b)return(0,o.jsxs)("main",{className:H().exhibitionDetail,children:[(0,o.jsx)(l.A,{title:t("loading"),showBackArrow:!0,showBack:!0,onBackClick:()=>window.history.back()}),(0,o.jsx)("div",{style:{padding:16},children:(0,o.jsx)("p",{children:t("loading")})})]});if(x)return(0,o.jsxs)("main",{className:H().exhibitionDetail,children:[(0,o.jsx)(l.A,{title:t("error"),showBackArrow:!0,showBack:!0,onBackClick:()=>window.history.back()}),(0,o.jsxs)("div",{style:{padding:16},children:[(0,o.jsx)("p",{style:{color:"var(--scheme-error)"},children:x.message}),(0,o.jsx)("button",{onClick:d,style:{marginTop:8},children:t("refresh")})]})]});if(!c)return(0,o.jsxs)("main",{className:H().exhibitionDetail,children:[(0,o.jsx)(l.A,{title:t("noContent"),showBackArrow:!0,showBack:!0,onBackClick:()=>window.history.back()}),(0,o.jsx)("div",{style:{padding:16},children:(0,o.jsx)("p",{children:t("noContent")})})]});let{basicInfo:q}=c;return(0,o.jsxs)("div",{className:H().exhibitionDetailWrapper,children:[" ",(0,o.jsxs)("main",{ref:P,className:H().exhibitionDetail,"data-scroll-container":!0,children:[(0,o.jsx)(l.A,{title:U?q.title:void 0,showBackArrow:!0,showRight:!0,rightButtonType:"help",variant:U?"default":"transparent",onBackClick:()=>window.history.back(),onRightClick:()=>{},className:H().exhibitionDetail__navbar}),(0,o.jsx)("div",{ref:O,className:H().exhibitionHeader,children:(0,o.jsxs)("div",{className:H().exhibitionHeader__imageWrapper,children:[(0,o.jsx)(s.$,{src:q.bannerImage,alt:q.title,fill:!0,className:H().exhibitionHeader__image,priority:!0}),(0,o.jsx)("div",{className:H().exhibitionHeader__overlay})]})}),(0,o.jsx)("div",{ref:A,className:"".concat(H().exhibitionDetail__tabContainer," ").concat(U?H().exhibitionDetail__tabContainer_sticky:""),children:(0,o.jsx)(B.m,{children:(0,o.jsx)(h.o,{variant:"flat",activeLineMode:"full",isHeaderSticky:U,enableSwiper:!1,items:[{key:"intro",title:e("tabs.intro"),content:(0,o.jsx)(w,{basicInfo:q,featuredWorks:c.featuredWorks,onViewLocation:z,onViewMoreWorks:F,onWorkClick:R})},{key:"works",title:e("tabs.works"),content:(0,o.jsx)("div",{style:{paddingTop:"16px"},children:(0,o.jsx)(j,{workCategories:c.workCategories,exhibitionID:i,exhibitionName:q.title})})}],activeKey:k,onChange:i=>u(i)})})})]}),(0,o.jsx)(y.F,{onClick:()=>m(!0),bottomOffset:80*!!N}),(0,o.jsx)(E.T,{visible:I,onClose:()=>m(!1)}),X&&(0,o.jsx)(L.D,{visible:p,onClose:()=>v(!1),mode:"exhibition",exhibition:X,onWorkActionClick:Q})]})}},37697:i=>{i.exports={worksListContainer:"ExhibitionWorksList_worksListContainer__e7tWg",worksListContainer__startButton:"ExhibitionWorksList_worksListContainer__startButton__qf6Z6",worksListContainer__categories:"ExhibitionWorksList_worksListContainer__categories__UfbYT",worksListContainer__category:"ExhibitionWorksList_worksListContainer__category__4HCa9",worksListContainer__worksList:"ExhibitionWorksList_worksListContainer__worksList__nIwWx"}},47677:i=>{i.exports={exhibitionIntro:"ExhibitionIntro_exhibitionIntro__63UgO",exhibitionIntro__title:"ExhibitionIntro_exhibitionIntro__title__iLzX3",exhibitionIntro__info:"ExhibitionIntro_exhibitionIntro__info__cbu3P",exhibitionIntro__locationButton:"ExhibitionIntro_exhibitionIntro__locationButton__5c6MX",exhibitionIntro__worksPreview:"ExhibitionIntro_exhibitionIntro__worksPreview__Uppso",exhibitionIntro__worksHeader:"ExhibitionIntro_exhibitionIntro__worksHeader__9zDUB",exhibitionIntro__worksHeaderRow:"ExhibitionIntro_exhibitionIntro__worksHeaderRow__BtF8Q",exhibitionIntro__worksTitle:"ExhibitionIntro_exhibitionIntro__worksTitle__6DlK7",exhibitionIntro__viewMoreButton:"ExhibitionIntro_exhibitionIntro__viewMoreButton__KsPpv",exhibitionIntro__worksDivider:"ExhibitionIntro_exhibitionIntro__worksDivider__A0ssD",exhibitionIntro__worksList:"ExhibitionIntro_exhibitionIntro__worksList__Hk4mQ",exhibitionIntro__workCard:"ExhibitionIntro_exhibitionIntro__workCard__I1qeg",exhibitionIntro__workImageWrapper:"ExhibitionIntro_exhibitionIntro__workImageWrapper__AxC8_",exhibitionIntro__workImage:"ExhibitionIntro_exhibitionIntro__workImage__tQP7f",exhibitionIntro__workImageOverlay:"ExhibitionIntro_exhibitionIntro__workImageOverlay__3oRWi",exhibitionIntro__workTitle:"ExhibitionIntro_exhibitionIntro__workTitle__zl5bb"}},48244:(i,e,t)=>{Promise.resolve().then(t.bind(t,36732))},53365:i=>{i.exports={exhibitionDetailWrapper:"page_exhibitionDetailWrapper__CoEQq",exhibitionDetail:"page_exhibitionDetail__x7dbH",exhibitionDetail__navbar:"page_exhibitionDetail__navbar__tn47h",exhibitionDetail__tabContainer:"page_exhibitionDetail__tabContainer__D2zAe",exhibitionDetail__banner:"page_exhibitionDetail__banner__OO8Yu",exhibitionDetail__bannerImage:"page_exhibitionDetail__bannerImage__IZ1x4",exhibitionDetail__bannerImg:"page_exhibitionDetail__bannerImg__XLyUm",exhibitionDetail__bannerOverlay:"page_exhibitionDetail__bannerOverlay__PDhbF",exhibitionDetail__bannerContent:"page_exhibitionDetail__bannerContent___1MqK",exhibitionDetail__title:"page_exhibitionDetail__title__OgQlH",exhibitionDetail__subtitle:"page_exhibitionDetail__subtitle__zvLO_",exhibitionDetail__bannerMeta:"page_exhibitionDetail__bannerMeta__81y8t",exhibitionDetail__bannerMetaItem:"page_exhibitionDetail__bannerMetaItem__eWC0F",exhibitionDetail__tabs:"page_exhibitionDetail__tabs__3PbCE",exhibitionDetail__content:"page_exhibitionDetail__content__9VINQ",exhibitionHeader:"page_exhibitionHeader__mdufI",exhibitionHeader__imageWrapper:"page_exhibitionHeader__imageWrapper__UPXGI",exhibitionHeader__image:"page_exhibitionHeader__image__gpJT7",exhibitionHeader__overlay:"page_exhibitionHeader__overlay__LXX3_",exhibitionHeader__content:"page_exhibitionHeader__content__wufyd",exhibitionHeader__title:"page_exhibitionHeader__title__hPrOi",exhibitionHeader__metadata:"page_exhibitionHeader__metadata__YldHm",exhibitionHeader__metadataItem:"page_exhibitionHeader__metadataItem__UYJUI"}}},i=>{i.O(0,[4676,9152,7906,9681,564,7020,4772,4730,3678,6208,4576,4078,1778,9120,664,443,8471,9402,5510,7358],()=>i(i.s=48244)),_N_E=i.O()}]);