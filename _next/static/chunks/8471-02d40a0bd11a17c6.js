(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8471],{3765:e=>{e.exports={floatingBubble:"FloatingBubble_floatingBubble__BnRmh"}},8804:(e,t,a)=>{"use strict";a.d(t,{j:()=>c});var r=a(81556),o=a(47256),n=a(83678),l=a(18255),i=a.n(l);let c=o.forwardRef((e,t)=>{let{length:a=3,error:o=!1,caret:l=!0,value:c,defaultValue:s,onChange:_,onFill:d,onFocus:u,onBlur:h,className:p,"aria-label":b,...m}=e;return(0,r.jsx)(n.jW,{...m,ref:t,length:a,seperated:!0,plain:!0,error:o,caret:l,value:c,defaultValue:s,onChange:_,onFill:d,onFocus:u,onBlur:h,className:"".concat(i().passcodeInput," ").concat(p||""),"aria-label":b,"aria-invalid":o||void 0,style:{"--cell-size":"64px","--cell-gap":"8px","--border-radius":"8px","--border-color":o?"#f36363":"#595959",...m.style}})});c.displayName="PasscodeInput"},10433:e=>{e.exports={dialog:"Dialog_dialog__He66e","adm-dialog-button-bold":"Dialog_adm-dialog-button-bold__sh2xe"}},12310:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(81556);a(47256);var o=a(39660),n=a(52728),l=a(86725),i=a.n(l);let c=e=>{let{image:t,imageAlt:a,title:l,location:c,exhibitionTitle:s,onClick:_,className:d=""}=e,u=[i().workCardSearch,_&&i()["workCardSearch--clickable"],d].filter(Boolean).join(" ");return(0,r.jsxs)("div",{className:u,onClick:_,role:_?"button":void 0,tabIndex:_?0:void 0,"aria-label":_?"查看 ".concat(l," 詳情，位置：").concat(c.floor," ").concat(c.room,"，展覽：").concat(s):void 0,onKeyDown:e=>{_&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),_())},children:[(0,r.jsx)("div",{className:i().workCardSearch__imageWrapper,children:(0,r.jsx)(o.$,{src:t,alt:a||l,width:96,height:96,className:i().workCardSearch__image})}),(0,r.jsxs)("div",{className:i().workCardSearch__body,children:[(0,r.jsxs)("div",{className:i().workCardSearch__header,children:[(0,r.jsxs)("div",{className:i().workCardSearch__headerGroup,children:[(0,r.jsxs)("div",{className:i().workCardSearch__location,children:[(0,r.jsx)("span",{className:i().workCardSearch__floor,children:c.floor}),(0,r.jsx)("span",{className:i().workCardSearch__room,children:c.room})]}),(0,r.jsx)("h3",{className:i().workCardSearch__title,children:l})]}),_&&(0,r.jsx)("div",{className:i().workCardSearch__arrow,"aria-hidden":"true",children:(0,r.jsx)(n.A0.Outline,{size:14,color:"white"})})]}),(0,r.jsx)("div",{className:i().workCardSearch__footer,children:(0,r.jsx)("p",{className:i().workCardSearch__exhibitionTitle,children:s})})]})]})};c.displayName="WorkCardSearch";let s=c},13695:e=>{e.exports={container:"Container_container__XXTJc"}},18255:e=>{e.exports={passcodeInput:"PasscodeInput_passcodeInput__nBX9R"}},18439:e=>{e.exports={tab:"Tab_tab__F0Hng",tab__header:"Tab_tab__header__LTdUD","tab__header--sticky":"Tab_tab__header--sticky__gPtSM",tab__content:"Tab_tab__content__px4Hs",tab__panel:"Tab_tab__panel__m017Q","tab--rounded":"Tab_tab--rounded__fGZqY","tab--flat":"Tab_tab--flat__2p51d"}},22743:e=>{e.exports={textContent:"TextContent_textContent__C_fA5",textContent__item:"TextContent_textContent__item__yjuVQ",textContent__label:"TextContent_textContent__label__99t7q",textContent__value:"TextContent_textContent__value__9UwW0"}},26448:e=>{e.exports={overlay:"TourSearchPopup_overlay__KYmhU",header:"TourSearchPopup_header__M8o_b",title:"TourSearchPopup_title__QjsE4",closeBtn:"TourSearchPopup_closeBtn__hii6e",contentArea:"TourSearchPopup_contentArea__fynF7",placeholder:"TourSearchPopup_placeholder__gJmZF",passcodeWrapper:"TourSearchPopup_passcodeWrapper__9_yZ_",errorWrapper:"TourSearchPopup_errorWrapper__NGxka",resultList:"TourSearchPopup_resultList__aoJHg"}},26802:(e,t,a)=>{"use strict";a.d(t,{d:()=>c});var r=a(81556),o=a(47256),n=a(83678),l=a(99393),i=a.n(l);let c=e=>{let{visible:t=!1,title:a,confirmText:l="確定",customKey:c,showCloseButton:s=!0,onInput:_,onDelete:d,onClose:u,onConfirm:h,closeOnConfirm:p=!0,safeArea:b=!0,className:m,"aria-label":x,...C}=e;return(0,o.useEffect)(()=>(t?document.body.setAttribute("data-number-keyboard-visible","true"):document.body.removeAttribute("data-number-keyboard-visible"),()=>{document.body.removeAttribute("data-number-keyboard-visible")}),[t]),(0,r.jsx)(n.d_,{...C,visible:t,title:a,confirmText:l,customKey:c,showCloseButton:s,onInput:_,onDelete:d,onClose:u,onConfirm:h,closeOnConfirm:p,safeArea:b,className:"".concat(i().numberKeyboard," ").concat(m||""),"aria-label":x})};c.displayName="NumberKeyboard"},46682:(e,t,a)=>{"use strict";a.d(t,{T:()=>v});var r=a(81556),o=a(47256),n=a(54961),l=a(52728),i=a(8804),c=a(26802),s=a(12310),_=a(78338),d=a(65728),u=a(89120),h=a(47469),p=a(71526),b=a(34739),m=a(93257),x=a(91765),C=a(26448),k=a.n(C);let v=e=>{let{visible:t,locale:a,onClose:C,onPlay:v,defaultNumber:g}=e,f=(0,n.useParams)(),S=a||("string"==typeof(null==f?void 0:f.locale)?f.locale:"zh-TW"),y=(0,b.c3)("search"),j=(0,b.c3)("common"),w=(0,u._)(),{version:N}=w,{play:I,setPlaylist:T,setWorkCategories:D,currentTrack:W}=(0,h.F)(),{contentVersionType:B,mediaType:P,getMediaInfoFromSearchResult:F,worksToPlaylist:R}=(0,p.S)(),[A,L]=(0,o.useState)(g||""),[U,O]=(0,o.useState)(!0),[G,K]=(0,o.useState)([]),[z,E]=(0,o.useState)("none"),M=(0,o.useRef)(null),[V,Q]=(0,o.useState)(null),[$,H]=(0,o.useState)(!1),q=(0,o.useCallback)(async e=>{if(!e){K([]),E("none");return}let t=await w.workSearch.searchByNumber(e);if(0===t.length)K([]),E("workNotFound");else{let e=t.filter(e=>e.audioURL);0===e.length?(K([]),E("noAudioInLanguage")):(K(e),E("none"))}},[w.workSearch]);(0,o.useEffect)(()=>{if(t){if(0===A.length){K([]),E("none");return}3===A.length?q(A):(K([]),E("none"))}},[S,t,A,q]);let J=(0,o.useCallback)(e=>{/^\d$/.test(e)&&L(t=>t.length>=3?t:t+e)},[]),X=(0,o.useCallback)(()=>L(e=>e.slice(0,-1)),[]),Y=(0,o.useCallback)(()=>{A.length>0&&q(A)},[q,A]),Z=(0,o.useCallback)(e=>{var t;let a=F(e);return{id:e.workID,title:e.title,thumbnail:e.image,exhibitionID:e.exhibitionID,exhibitionName:e.exhibitionTitle,floor:e.floor,room:e.room,has3DModel:e.has3DModel,contentVersionType:B,contents:a.url&&a.contentID?[{id:a.contentID,type:P,url:a.url,duration:null!=(t=a.duration)?t:0,status:"available"}]:[]}},[B,P,F]),ee=(0,o.useCallback)(async e=>{if(x.vF.debug("[TourSearchPopup] playSearchResult called",{workID:e.workID,title:e.title,audioURL:e.audioURL,audioContentID:e.audioContentID,exhibitionID:e.exhibitionID}),v)return void v(e);let t=Z(e);if(x.vF.debug("[TourSearchPopup] Track data created",{trackId:t.id,contentsLength:t.contents.length,contents:t.contents}),e.exhibitionID)try{let a=await (0,m.nW)(e.exhibitionID,S,N),r=a.workCategories.flatMap(e=>e.works);if(r.length>0){let o=e.exhibitionTitle||a.basicInfo.title,n=R(r,{exhibitionID:e.exhibitionID,exhibitionName:o}),l=n.findIndex(t=>t.id===e.workID);if(-1!==l){n[l]={...n[l],contents:t.contents};let r=n[l];x.vF.debug("[TourSearchPopup] Setting exhibition playlist",{exhibitionID:e.exhibitionID,playlistLength:n.length,currentIndex:l,trackToPlay:{id:r.id,title:r.title,contentsLength:r.contents.length,hasAudio:r.contents.length>0}}),T(n,l),D(a.workCategories),x.vF.debug("[TourSearchPopup] Calling play()",{trackId:r.id}),I(r);return}}}catch(t){x.vF.warn("[TourSearchPopup] Failed to load exhibition, using single track",{exhibitionID:e.exhibitionID,error:t})}x.vF.debug("[TourSearchPopup] Using fallback single track play",{trackId:t.id,contentsLength:t.contents.length}),T([t],0),I(t)},[v,Z,I,T,D,S,N,R]),et=(0,o.useCallback)(e=>{if(U){var t;O(!1),null==(t=M.current)||t.blur()}if(W&&W.exhibitionID!==e.exhibitionID){Q(e),H(!0);return}ee(e)},[W,ee,U]),ea=(0,o.useMemo)(()=>[{key:"cancel",text:y("switchTour.cancel")},{key:"confirm",text:y("switchTour.confirm"),bold:!0}],[y]),er="none"!==z;return t?(0,r.jsxs)("div",{className:k().overlay,role:"dialog","aria-modal":"true","aria-label":y("enterWorkNumber"),children:[(0,r.jsxs)("header",{className:k().header,children:[(0,r.jsx)("h1",{className:k().title,children:y("title")}),(0,r.jsx)("button",{className:k().closeBtn,"aria-label":j("close"),onClick:C,children:(0,r.jsx)(l.gz,{})})]}),(0,r.jsxs)("div",{className:k().contentArea,children:[!er&&0===G.length&&(0,r.jsxs)("div",{className:k().placeholder,children:[(0,r.jsx)(l.Ts.Outline,{}),(0,r.jsx)("p",{children:y("subtitle")})]}),(0,r.jsx)("div",{className:k().passcodeWrapper,children:(0,r.jsx)(i.j,{length:3,value:A,error:er,onChange:e=>L(e.replace(/[^\d]/g,"").slice(0,3)),onFill:e=>L(e),onFocus:()=>O(!0),ref:M,"aria-label":y("enterWorkNumber")})}),er&&(0,r.jsx)("div",{className:k().errorWrapper,children:(0,r.jsx)(d.S,{icon:(0,r.jsx)(l.Vg,{}),title:y("errors.".concat(z))})}),!er&&G.length>0&&(0,r.jsx)("div",{className:k().resultList,children:G.map(e=>(0,r.jsx)(s.A,{image:e.image,title:e.title,location:{floor:e.floor||"",room:e.room||""},exhibitionTitle:e.exhibitionTitle||"",onClick:()=>et(e)},e.workID))})]}),(0,r.jsx)(c.d,{visible:U,showCloseButton:!0,safeArea:!1,onInput:J,onDelete:X,onClose:()=>{var e;O(!1),null==(e=M.current)||e.blur()},onConfirm:Y,"aria-label":y("numberKeyboard")}),(0,r.jsx)(_.l,{visible:$,title:y("switchTour.title"),content:y("switchTour.content"),actions:ea,onAction:e=>{"confirm"===e.key&&V&&ee(V),H(!1),Q(null)},onClose:()=>H(!1)})]}):null}},51700:(e,t,a)=>{"use strict";a.d(t,{m:()=>l});var r=a(81556);a(47256);var o=a(13695),n=a.n(o);let l=e=>{let{children:t,className:a}=e;return(0,r.jsx)("div",{className:"".concat(n().container," ").concat(a||""),children:t})};l.displayName="Container"},53277:(e,t,a)=>{"use strict";a.d(t,{o:()=>r.o});var r=a(93212)},54961:(e,t,a)=>{"use strict";var r=a(60541);a.o(r,"permanentRedirect")&&a.d(t,{permanentRedirect:function(){return r.permanentRedirect}}),a.o(r,"redirect")&&a.d(t,{redirect:function(){return r.redirect}}),a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},60727:e=>{e.exports={content:"Content_content__iy0_k",content__textBlock:"Content_content__textBlock__da4eu",content__paragraph:"Content_content__paragraph__29iYX",content__imageBlock:"Content_content__imageBlock__sF7s9",content__imageWrapper:"Content_content__imageWrapper__woGWv",content__image:"Content_content__image__LOL3V",content__imageCaption:"Content_content__imageCaption__2V2zV",content__videoBlock:"Content_content__videoBlock__ixP0N",content__videoCover:"Content_content__videoCover__dkgLg",content__videoCoverOverlay:"Content_content__videoCoverOverlay__lz7PJ",content__videoCoverImage:"Content_content__videoCoverImage__A3FVa",content__video:"Content_content__video__jhx_l",content__videoTitle:"Content_content__videoTitle__QLo4u"}},65728:(e,t,a)=>{"use strict";a.d(t,{S:()=>i});var r=a(81556);a(47256);var o=a(83678),n=a(67819),l=a.n(n);let i=e=>{let{title:t,description:a,icon:n=null,className:i,...c}=e,s=null!=n;return(0,r.jsx)(o.Q7,{...c,title:t,description:a,icon:n,className:"".concat(l().resultCard," ").concat(s?l().hasIcon:l().noIcon," ").concat(i||"")})};i.displayName="ResultCard"},67819:e=>{e.exports={resultCard:"ResultCard_resultCard__pyOFi",noIcon:"ResultCard_noIcon__6pREw"}},68793:(e,t,a)=>{"use strict";a.d(t,{U:()=>u});var r=a(81556),o=a(47256),n=a(39660),l=a(52728),i=a(60727),c=a.n(i);let s=e=>{let{block:t}=e;return(0,r.jsx)("section",{className:c().content__textBlock,children:t.content.split("\n\n").map((e,t)=>(0,r.jsx)("p",{className:c().content__paragraph,children:e},t))})},_=e=>{let{block:t}=e;return(0,r.jsxs)("figure",{className:c().content__imageBlock,children:[(0,r.jsx)("div",{className:c().content__imageWrapper,children:(0,r.jsx)(n.$,{src:t.src,alt:t.alt,fill:!0,className:c().content__image,sizes:"(max-width: 768px) 100vw, 768px"})}),t.caption&&(0,r.jsx)("figcaption",{className:c().content__imageCaption,children:t.caption})]})},d=e=>{let{block:t}=e,[a,i]=(0,o.useState)(!1);return(0,r.jsxs)("div",{className:c().content__videoBlock,children:[a?(0,r.jsxs)("video",{className:c().content__video,controls:!0,autoPlay:!0,preload:"metadata",poster:t.thumbnail,children:[(0,r.jsx)("source",{src:t.video_url,type:"video/mp4"}),(0,r.jsx)("span",{children:"您的瀏覽器不支援影片播放。"})]}):(0,r.jsxs)("button",{className:c().content__videoCover,onClick:()=>{i(!0)},"aria-label":"播放影片".concat(t.title?": ".concat(t.title):""),children:[t.thumbnail&&(0,r.jsx)(n.$,{src:t.thumbnail,alt:t.title||"影片封面",fill:!0,className:c().content__videoCoverImage}),(0,r.jsx)("div",{className:c().content__videoCoverOverlay,children:(0,r.jsx)(l.UG.Outline,{size:64,color:"white"})})]}),t.title&&(0,r.jsx)("p",{className:c().content__videoTitle,children:t.title})]})},u=e=>{let{blocks:t,className:a=""}=e;return(0,r.jsx)("article",{className:"".concat(c().content," ").concat(a),children:t.map((e,t)=>{switch(e.type){case"text":return(0,r.jsx)(s,{block:e},t);case"image":return(0,r.jsx)(_,{block:e},t);case"video":return(0,r.jsx)(d,{block:e},t);default:return null}})})};u.displayName="Content"},70218:(e,t,a)=>{"use strict";a.d(t,{n:()=>l});var r=a(81556);a(47256);var o=a(22743),n=a.n(o);let l=e=>{let{items:t,className:a}=e;return(0,r.jsx)("div",{className:"".concat(n().textContent," ").concat(a||""),children:t.map((e,t)=>(0,r.jsxs)("div",{className:n().textContent__item,children:[(0,r.jsx)("p",{className:n().textContent__label,children:e.label}),(0,r.jsx)("p",{className:n().textContent__value,children:e.value})]},t))})}},70254:(e,t,a)=>{"use strict";a.d(t,{A:()=>r.A});var r=a(35566)},72863:(e,t,a)=>{"use strict";a.d(t,{U:()=>r.U});var r=a(95612)},76241:(e,t,a)=>{"use strict";a.d(t,{m:()=>r.m});var r=a(51700)},78338:(e,t,a)=>{"use strict";a.d(t,{l:()=>i});var r=a(81556);a(47256);var o=a(83678),n=a(10433),l=a.n(n);let i=e=>{let{title:t,content:a,actions:n=[{key:"cancel",text:"先不要"},{key:"confirm",text:"好",bold:!0}],visible:i,onAction:c,onClose:s,className:_,...d}=e;return(0,r.jsx)(o.lG,{...d,visible:i,title:t,content:a,actions:n,onAction:c,onClose:s,className:"".concat(l().dialog," ").concat(_||"")})};i.displayName="Dialog"},86725:e=>{e.exports={workCardSearch:"WorkCardSearch_workCardSearch__FhQ_n","workCardSearch--clickable":"WorkCardSearch_workCardSearch--clickable__VnIud",workCardSearch__imageWrapper:"WorkCardSearch_workCardSearch__imageWrapper__0ML5G",workCardSearch__image:"WorkCardSearch_workCardSearch__image__dnlc_",workCardSearch__body:"WorkCardSearch_workCardSearch__body__2OD_v",workCardSearch__header:"WorkCardSearch_workCardSearch__header__cSNIA",workCardSearch__headerGroup:"WorkCardSearch_workCardSearch__headerGroup__LRB4p",workCardSearch__location:"WorkCardSearch_workCardSearch__location__jgl6D",workCardSearch__floor:"WorkCardSearch_workCardSearch__floor__8uyah",workCardSearch__room:"WorkCardSearch_workCardSearch__room__xHs2d",workCardSearch__title:"WorkCardSearch_workCardSearch__title__kDqqs",workCardSearch__arrow:"WorkCardSearch_workCardSearch__arrow__5x0IU",workCardSearch__footer:"WorkCardSearch_workCardSearch__footer__R0teD",workCardSearch__exhibitionTitle:"WorkCardSearch_workCardSearch__exhibitionTitle__QCG4B"}},93212:(e,t,a)=>{"use strict";a.d(t,{A:()=>s,o:()=>c});var r=a(81556),o=a(47256),n=a(83678),l=a(18439),i=a.n(l);let c=e=>{var t;let{items:a,defaultActiveKey:l,activeKey:c,onChange:s,enableSwiper:_=!0,activeLineMode:d="full",variant:u="rounded",isHeaderSticky:h=!1,stickyTop:p,hideHeader:b=!1,className:m=""}=e,[x,C]=(0,o.useState)(l||(null==(t=a[0])?void 0:t.key)||""),k=(0,o.useRef)(null),v=void 0!==c?c:x,g=[i().tab,"flat"===u?i()["tab--flat"]:i()["tab--rounded"],m].filter(Boolean).join(" "),f=[i().tab__header,h?i()["tab__header--sticky"]:""].filter(Boolean).join(" ");return(0,r.jsxs)("div",{className:g,children:[!b&&(0,r.jsx)(n.tU,{activeKey:v,onChange:e=>{void 0===c&&C(e);let t=a.findIndex(t=>t.key===e);if(-1!==t&&_){var r;null==(r=k.current)||r.swipeTo(t)}null==s||s(e)},activeLineMode:d,className:f,style:void 0!==p?{top:"".concat(p,"px")}:void 0,children:a.map(e=>(0,r.jsx)(n.tU.Tab,{title:e.title,disabled:e.disabled},e.key))}),_?(0,r.jsx)(n.RC,{ref:k,defaultIndex:a.findIndex(e=>e.key===v),onIndexChange:e=>{var t;let r=null==(t=a[e])?void 0:t.key;r&&r!==v&&(void 0===c&&C(r),null==s||s(r))},indicator:!1,allowTouchMove:!0,className:i().tab__content,style:{"--height":"auto"},children:a.map(e=>(0,r.jsx)(n.RC.Item,{children:e.content},e.key))}):(0,r.jsx)("div",{className:i().tab__content,children:a.map(e=>(0,r.jsx)("div",{className:i().tab__panel,style:{display:e.key===v?"block":"none"},children:e.content},e.key))})]})};c.displayName="Tab";let s=c},93855:(e,t,a)=>{"use strict";a.d(t,{F:()=>c});var r=a(81556);a(47256);var o=a(83678),n=a(52728),l=a(3765),i=a.n(l);let c=e=>{let{children:t,onClick:a,axis:l="xy",magnetic:c="x",offset:s,onOffsetChange:_,"aria-label":d="浮動按鈕",bottomOffset:u=0,...h}=e;return(0,r.jsx)("div",{className:i().floatingBubble,children:(0,r.jsx)(o.Fc,{...h,axis:l,magnetic:c,offset:s,onOffsetChange:_,onClick:a,"aria-label":d,style:{"--initial-position-bottom":"calc(".concat(18+u,"px + env(safe-area-inset-bottom, 0px))"),"--initial-position-right":"12px","--edge-distance":"12px","--background":"#ba9972","--size":"48px","--border-radius":"48px"},children:(0,r.jsx)("div",{style:{pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:t||(0,r.jsx)(n.Ts.Outline,{color:"black",size:32})})})})};c.displayName="FloatingBubble"},97360:(e,t,a)=>{"use strict";a.d(t,{$:()=>r.$});var r=a(95610)},99393:e=>{e.exports={numberKeyboard:"NumberKeyboard_numberKeyboard__oA3GB"}}}]);